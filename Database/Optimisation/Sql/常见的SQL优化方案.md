#### 数据库SQL常见优化手段

---

1. 任何地方都不要使用select * from table, 使用具体的字段列表代替 *, 不返回用不到的数据
2. 尽量避免子查询
3. 用in替换or
4. 查询数据时, 使用Limit M N读取适当的数据, 而不读取多余的数据
5. 总和查询可以使用禁止排序去重的union all
6. 将多次插入替换成批量插入
7. 区分in和exists



#### 避免子查询

---

**原因**: 子查询效率太差, MySQL在执行子查询时, 需要创建临时表, 所以子查询的速度会受到一定的影响, 这里多了一个创建和销毁临时表的过程.

**优化手段**: 尽量使用join去替换子查询



#### 用in替换or

---

查询字段在没有主键或者索引的情况下, 随着in和or后面的查询数据越来越多, 

or的执行效率会明显下降, and的执行效率不会明显下降



#### 查询数据时, 使用Limit M N读取适当的数据, 而不读取多余的数据

---

分页查询:

```
select * from table limit m,n;
```

上述SQL会随着m值的增大而变慢.

在特定的条件下, 我们可以利用主键自增的特点, 取上一页最大的主键进行过滤进行再取对应的数据

```
select * from table where id > x limit n;
```



#### UNION和UNION ALL的区别

---

##### 去重处理:

1. UNION: 合并两个或多个select语句的查询结果集时, 会自动去除重复的行, 确保最终的结果集不包含重复的行.

2. UNION ALL: 合并两个或多个select语句的查询结果集时, 不会自动去除重复的行, 直接将所有的行拼接在一起返回.

##### 排序处理:

1. UNION: 合并结果集后, 会对结果集进行排序操作
2. UNION ALL: 不会对合并后的结果集进行排序处理



#### Mysql中EXISTS和IN的区别是什么?

---

在MySql中, exists和in都是用于在子查询中进行提交判断, 但它们的使用场景和性能有一定的区别. 以下是exists和的主要区别:

##### 功能和用法:

EXISTS:

1. exists用于检查子查询是否返回至少一条数据. 如果子查询返回至少一条数据, 则exists的条件为真, 否则为假.
2. exists通常与select子查询一起使用, 判断是否存在符合的记录.
3. exists子查询一般不返回数据, 它只判断数据是否存在.

IN:

1. in用于判断某个值是否存在于一个指定的集合或者子查询的结果集中
2. in子查询会返回一个值的列表, 主查询会检查某个字段是否在这个列表中

##### 适用场景:

EXISTS:

1. 用于检查某种条件是否存在的情况, 尤其是子查询返回大量数据时
2. 如果子查询没有需要返回的列, 而只需要检查行的存在性, exists更合适.

IN:

1. 适用于需要在主查询中检查字段是否存在于某个集合的情况
2. 如果子查询返回的结果集较小, in更合适.

##### 子查询返回的内容:

1. exists: 子查询返回的列可以是任意列或常量, 返回的内容对exists并不重要, 它只关心是否存在数据
2. in: 子查询返回的列必须是与主查询中被比较的字段匹配的数据类型, 并且返回值将于主查询的字段进行比较.

##### 处理null值的方式:

1. exists: 不关心子查询是否有null值, 它只检查子查询是否返回至少一条数据
2. in: 如果子查询返回null值, 且主查询的字段与null值进行比较, 结果可能受到影响. 



#### 统计数量

---

select count(*): 语义最清晰（明确表示"计算行数"）, 性能通常最优, 计算表中的所有行，**包括所有NULL值行**

select count(1): 计算表中的所有行，**包括所有NULL值行**

select count(字段): **即不统计字段为null 的记录**











